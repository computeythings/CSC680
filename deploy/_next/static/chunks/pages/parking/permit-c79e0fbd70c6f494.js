(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{423:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/parking/permit",function(){return a(9775)}])},1912:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var s=a(7876),l=a(4232),n=a(2101),r=a.n(n);let i=e=>{let{number:t}=e,a=(0,l.useRef)(null);return((0,l.useEffect)(()=>{a.current&&r()(a.current,t,{format:"CODE128",lineColor:"#000",width:2,height:60,displayValue:!1})},[t]),t)?(0,s.jsx)("svg",{ref:a,className:"mx-auto"}):null}},3610:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(7876),l=a(5),n=a(4232);function r(e){let{selectedLot:t,onLotSelect:a}=e,[r,i]=(0,n.useState)([]);return(0,n.useEffect)(()=>{l.nV.getLots().then(e=>{200==e.statusCode?i(e.data.data):alert("Unable to connect to server.")})},[]),(0,s.jsxs)("div",{className:"flex items-center justify-center relative p-4",children:[(0,s.jsx)("span",{className:"float-right",children:"Parking Lot:"}),(0,s.jsxs)("select",{value:t,onChange:a,className:"p-1 border min-w-80",children:[(0,s.jsx)("option",{value:-1,disabled:!0,hidden:!0,children:"-- Select a Lot --"}),r.map(e=>(0,s.jsx)("option",{value:e.id,children:"".concat(e.street," ").concat(e.city,", ").concat(e.state," ").concat(e.zip_code)},e.id))]})]})}},9775:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var s=a(7876),l=a(4232);let n=(0,l.forwardRef)((e,t)=>{let[a,n]=(0,l.useState)(!1),[r,i]=(0,l.useState)({x:0,y:0});return((0,l.useImperativeHandle)(t,()=>({flash:()=>{i({x:20+5*Math.floor(14*Math.random()),y:20+5*Math.floor(14*Math.random())}),n(!1),requestAnimationFrame(()=>n(!0))}})),(0,l.useEffect)(()=>{if(!a)return;let e=setTimeout(()=>{n(!1)},300);return()=>clearTimeout(e)},[a]),a)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"white",opacity:1,animation:"flashFade 0.3s forwards",pointerEvents:"none",zIndex:9999}}),(0,s.jsx)("div",{style:{position:"fixed",top:"".concat(r.y,"%"),left:"".concat(r.x,"%"),backgroundColor:"white",color:"black",padding:"1rem 2rem",borderRadius:4,boxShadow:"0 0 10px rgba(0,0,0,0.2)",fontWeight:"bold",fontSize:"1.5rem",pointerEvents:"none",zIndex:1e4,fontFamily:"Courier New"},children:"CLICK."})]}):null});var r=a(5),i=a(3610),o=a(1912);function c(e){let{id:t,spot:a,licenseplate:l,make:n,model:r,firstname:i,lastname:c,entry:d}=e;return(0,s.jsxs)("div",{className:"border w-150 mx-auto my-10",children:[(0,s.jsxs)("h1",{className:"text-xl font-bold my-8",children:["PARKING SLIP #",t.padStart(6,"0")]}),(0,s.jsx)("div",{className:"px-20 my-4",children:(0,s.jsxs)("div",{style:{fontFamily:"Consolas"},children:[(0,s.jsxs)("p",{className:"px-5 my-4",children:["PARKING SPOT: ",a]}),(0,s.jsxs)("p",{className:"px-5 my-4",children:["LICENSE PLATE: ",l]}),(0,s.jsxs)("p",{className:"px-5 my-4",children:["VEHCILE: ","".concat(n.toUpperCase()," ").concat(r.toUpperCase())]}),(0,s.jsxs)("p",{className:"px-5 my-4",children:["CUSTOMER NAME: ","".concat(i.toUpperCase()," ").concat(c.toUpperCase())]}),(0,s.jsxs)("p",{className:"px-5 my-4",children:["ENTRY TIME: ",d," "]}),(0,s.jsx)(o.A,{number:t.padStart(6,"0")})]})})]})}var d=function(e){return e.LOT_FULL="FULL",e.SERVER_ERROR="ERROR",e.LOADING="LOADING",e.SUCCESS="SUCCESS",e}(d||{});function u(){let[e,t]=(0,l.useState)(-1),[a,o]=(0,l.useState)(!0),[d,u]=(0,l.useState)(null),[x,m]=(0,l.useState)("SUCCESS"),h=(0,l.useRef)(null);return(0,s.jsxs)("div",{className:"w-full content-center",children:[(0,s.jsx)(n,{ref:h}),(0,s.jsx)("div",{className:"bg-white mx-auto gap-4 text-black w-3/4 border overflow-hidden",children:(0,s.jsxs)("div",{className:"flex flex-col w-full text-center",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold my-4",children:"PARKING PERMITS"}),(0,s.jsx)(i.A,{selectedLot:e,onLotSelect:e=>{let a=Number(e.target.value);u(null),m("SUCCESS"),t(a)}}),(0,s.jsx)("button",{className:"border mx-auto px-2 my-4 ".concat(-1===e?"text-gray-200":"hover:shadow-sm cursor-pointer"),onClick:()=>{var t;null==(t=h.current)||t.flash(),o(!0),r.nV.newParkingSlip(e).then(e=>{if(200==e.statusCode){let t=e.data.data;u(t),0==t.slip_id?m("FULL"):m("SUCCESS")}else m("ERROR")}).finally(()=>{o(!1)})},children:"Issue Parking Slip"}),"SUCCESS"==x&&d?(0,s.jsxs)("div",{className:"flex flex-col ".concat(a?"invisible":""),children:[(0,s.jsx)("div",{className:"w-1/2 mx-auto justify-center",children:(0,s.jsx)("p",{style:{fontFamily:"Consolas"},children:"Our state-of-the-art robo photographer has captured this vehicle's license plate and extracted the driver's personal information!"})}),(0,s.jsx)("div",{className:"bg-[url('/images/licenseplatebg.png')] bg-cover text-4xl text-blue-800 w-60 h-30 mx-auto mt-2",children:(0,s.jsx)("div",{className:"mt-12 font-[Impact] tracking-widest",children:d.licenseplate})}),(0,s.jsx)(c,{id:d.slip_id.toString(),spot:d.spot,licenseplate:d.licenseplate,make:d.make,model:d.model,firstname:d.firstname,lastname:d.lastname,entry:new Date(1e3*d.start).toLocaleString()})]}):null,"ERROR"==x?(0,s.jsx)("div",{className:"flex flex-col ".concat(a?"invisible":""),children:(0,s.jsx)("div",{className:"w-1/2 mx-auto text-center justify-center my-4",children:(0,s.jsxs)("div",{style:{fontFamily:"Consolas"},children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"OOPS!"}),(0,s.jsx)("p",{children:"It appears our increasing reliance on fancy auto-information scraping technology has backfired and, as a result, we are now unable to permit entry to new vehicles at this time."}),(0,s.jsx)("p",{children:"Our downfall has been brought upon us as a result of our own hubris!"})]})})}):null,"FULL"==x?(0,s.jsx)("div",{className:"flex flex-col ".concat(a?"invisible":""),children:(0,s.jsxs)("div",{className:"w-1/4 mx-auto text-center justify-center my-4 border",children:[(0,s.jsx)("h1",{className:"text-red-500 font-bold text-2xl",children:"LOT FULL"}),(0,s.jsx)("p",{children:"Please come back later."})]})}):null]})})]})}var x=a(4598),m=a(9099);function h(){let{user:e}=(0,x.A)(),t=(0,m.useRouter)(),[a,n]=(0,l.useState)(!0);return((0,l.useEffect)(()=>{n(!1)},[e,t]),a)?null:e?["admin","parking_attendant"].includes(e.role)?(localStorage.removeItem("redirect"),(0,s.jsx)(u,{})):t.push("/"):(localStorage.setItem("redirect","/parking/permit/"),t.push("/login/"),null)}}},e=>{var t=t=>e(e.s=t);e.O(0,[647,636,593,792],()=>t(423)),_N_E=e.O()}]);