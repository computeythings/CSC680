(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{2804:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/parking/permit",function(){return s(9507)}])},3610:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(7876),l=s(5),n=s(4232);function r(e){let{selectedLot:t,onLotSelect:s}=e,[r,i]=(0,n.useState)([]);return(0,n.useEffect)(()=>{l.nV.getLots().then(e=>{200==e.statusCode?i(e.data.data):alert("Unable to connect to server.")})},[]),(0,a.jsxs)("div",{className:"flex items-center justify-center relative p-4",children:[(0,a.jsx)("span",{className:"float-right",children:"Parking Lot:"}),(0,a.jsxs)("select",{value:t,onChange:s,className:"p-1 border min-w-80",children:[(0,a.jsx)("option",{value:-1,disabled:!0,hidden:!0,children:"-- Select a Lot --"}),r.map(e=>(0,a.jsx)("option",{value:e.id,children:"".concat(e.street," ").concat(e.city,", ").concat(e.state," ").concat(e.zip_code)},e.id))]})]})}},9507:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var a=s(7876),l=s(4598),n=s(9099),r=s(4232);let i=(0,r.forwardRef)((e,t)=>{let[s,l]=(0,r.useState)(!1),[n,i]=(0,r.useState)({x:0,y:0});return((0,r.useImperativeHandle)(t,()=>({flash:()=>{i({x:20+5*Math.floor(14*Math.random()),y:20+5*Math.floor(14*Math.random())}),l(!1),requestAnimationFrame(()=>l(!0))}})),(0,r.useEffect)(()=>{if(!s)return;let e=setTimeout(()=>{l(!1)},300);return()=>clearTimeout(e)},[s]),s)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"white",opacity:1,animation:"flashFade 0.3s forwards",pointerEvents:"none",zIndex:9999}}),(0,a.jsx)("div",{style:{position:"fixed",top:"".concat(n.y,"%"),left:"".concat(n.x,"%"),backgroundColor:"white",color:"black",padding:"1rem 2rem",borderRadius:4,boxShadow:"0 0 10px rgba(0,0,0,0.2)",fontWeight:"bold",fontSize:"1.5rem",pointerEvents:"none",zIndex:1e4,fontFamily:"Courier New"},children:"CLICK."})]}):null});var o=s(2101),c=s.n(o);let d=e=>{let{number:t}=e,s=(0,r.useRef)(null);return((0,r.useEffect)(()=>{s.current&&c()(s.current,t,{format:"CODE128",lineColor:"#000",width:2,height:60,displayValue:!1})},[t]),t)?(0,a.jsx)("svg",{ref:s,className:"mx-auto"}):null};var u=s(5),x=s(3610),h=function(e){return e.LOT_FULL="FULL",e.SERVER_ERROR="ERROR",e.LOADING="LOADING",e.SUCCESS="SUCCESS",e}(h||{});function m(){let{user:e}=(0,l.A)(),t=(0,n.useRouter)(),[s,o]=(0,r.useState)(!0),[c,h]=(0,r.useState)(-1),[m,p]=(0,r.useState)(!1),[f,S]=(0,r.useState)(!0),[j,v]=(0,r.useState)(null),[N,b]=(0,r.useState)(!1),[y,C]=(0,r.useState)("SUCCESS"),E=(0,r.useRef)(null);return((0,r.useEffect)(()=>{o(!1)},[e,t]),s)?null:e?(localStorage.removeItem("redirect"),(0,a.jsxs)("div",{className:"w-full content-center",children:[(0,a.jsx)(i,{ref:E}),(0,a.jsx)("div",{className:"bg-white mx-auto gap-4 text-black w-3/4 border overflow-hidden",children:(0,a.jsxs)("div",{className:"flex flex-col w-full text-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold my-4",children:"PARKING PERMITS"}),(0,a.jsx)(x.A,{selectedLot:c,onLotSelect:e=>{let t=Number(e.target.value);v(null),C("SUCCESS"),h(t)}}),(0,a.jsx)("button",{className:"cursor-pointer border mx-auto px-2 my-4 hover:shadow-sm",onClick:()=>{var e;null==(e=E.current)||e.flash(),S(!0),u.nV.newParkingSlip(c).then(e=>{if(200==e.statusCode){let t=e.data.data;v(t),0==t.slip_id?C("FULL"):C("SUCCESS")}else C("ERROR")}).finally(()=>{S(!1)})},children:"Issue Parking Slip"}),"SUCCESS"==y&&j?(0,a.jsxs)("div",{className:"flex flex-col ".concat(f?"invisible":""),children:[(0,a.jsx)("div",{className:"w-1/2 mx-auto text-center justify-center",children:(0,a.jsx)("p",{style:{fontFamily:"Consolas"},children:"Our state-of-the-art robo photographer has captured this vehicle's license plate and extracted the driver's personal information!"})}),(0,a.jsx)("div",{className:"border text-3xl px-8 py-4 mx-auto my-4 rounded-md border-4",children:j.licenseplate}),(0,a.jsxs)("div",{className:"border text-center w-150 mx-auto my-10",children:[(0,a.jsxs)("h1",{className:"text-xl font-bold my-8",children:["PARKING SLIP #",j.slip_id.toString().padStart(6,"0")]}),(0,a.jsx)("div",{className:"px-20 my-4",children:(0,a.jsxs)("div",{style:{fontFamily:"Consolas"},children:[(0,a.jsxs)("p",{className:"px-5 my-4",children:["PARKING SPOT: ",j.spot]}),(0,a.jsxs)("p",{className:"px-5 my-4",children:["LICENSE PLATE: ",j.licenseplate]}),(0,a.jsxs)("p",{className:"px-5 my-4",children:["VEHCILE: ","".concat(j.make.toUpperCase()," ").concat(j.model.toUpperCase())]}),(0,a.jsxs)("p",{className:"px-5 my-4",children:["CUSTOMER NAME: ","".concat(j.firstname.toUpperCase()," ").concat(j.lastname.toUpperCase())]}),(0,a.jsxs)("p",{className:"px-5 my-4",children:["ENTRY TIME: ",new Date(1e3*j.start).toLocaleString()," "]}),(0,a.jsx)(d,{number:j.slip_id.toString().padStart(6,"0")})]})})]})]}):null,"ERROR"==y?(0,a.jsx)("div",{className:"flex flex-col ".concat(f?"invisible":""),children:(0,a.jsx)("div",{className:"w-1/2 mx-auto text-center justify-center my-4",children:(0,a.jsxs)("div",{style:{fontFamily:"Consolas"},children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"OOPS!"}),(0,a.jsx)("p",{children:"It appears our increasing reliance on fancy auto-information scraping technology has backfired and, as a result, we are now unable to permit entry to new vehicles at this time."}),(0,a.jsx)("p",{children:"Our downfall has been brought upon us as a result of our own hubris!"})]})})}):null,"FULL"==y?(0,a.jsx)("div",{className:"flex flex-col ".concat(f?"invisible":""),children:(0,a.jsxs)("div",{className:"w-1/4 mx-auto text-center justify-center my-4 border",children:[(0,a.jsx)("h1",{className:"text-red-500 font-bold text-2xl",children:"LOT FULL"}),(0,a.jsx)("p",{children:"Please come back later."})]})}):null]})})]})):(localStorage.setItem("redirect","/parking/permit/"),t.push("/login/"),null)}function p(){return(0,a.jsx)(m,{})}}},e=>{var t=t=>e(e.s=t);e.O(0,[647,636,593,792],()=>t(2804)),_N_E=e.O()}]);