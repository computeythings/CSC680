(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{423:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/parking/permit",function(){return s(9775)}])},1912:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var a=s(7876),l=s(4232),n=s(2101),r=s.n(n);let i=e=>{let{number:t}=e,s=(0,l.useRef)(null);return((0,l.useEffect)(()=>{s.current&&r()(s.current,t,{format:"CODE128",lineColor:"#000",width:2,height:60,displayValue:!1})},[t]),t)?(0,a.jsx)("svg",{ref:s,className:"mx-auto"}):null}},3610:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(7876),l=s(5),n=s(4232);function r(e){let{selectedLot:t,onLotSelect:s}=e,[r,i]=(0,n.useState)([]);return(0,n.useEffect)(()=>{l.nV.getLots().then(e=>{200==e.statusCode?i(e.data.data):alert("Unable to connect to server.")})},[]),(0,a.jsxs)("div",{className:"flex items-center justify-center relative p-4",children:[(0,a.jsx)("span",{className:"float-right",children:"Parking Lot:"}),(0,a.jsxs)("select",{value:t,onChange:s,className:"p-1 border min-w-80",children:[(0,a.jsx)("option",{value:-1,disabled:!0,hidden:!0,children:"-- Select a Lot --"}),r.map(e=>(0,a.jsx)("option",{value:e.id,children:"".concat(e.street," ").concat(e.city,", ").concat(e.state," ").concat(e.zip_code)},e.id))]})]})}},9775:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var a=s(7876),l=s(4598),n=s(9099),r=s(4232);let i=(0,r.forwardRef)((e,t)=>{let[s,l]=(0,r.useState)(!1),[n,i]=(0,r.useState)({x:0,y:0});return((0,r.useImperativeHandle)(t,()=>({flash:()=>{i({x:20+5*Math.floor(14*Math.random()),y:20+5*Math.floor(14*Math.random())}),l(!1),requestAnimationFrame(()=>l(!0))}})),(0,r.useEffect)(()=>{if(!s)return;let e=setTimeout(()=>{l(!1)},300);return()=>clearTimeout(e)},[s]),s)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"white",opacity:1,animation:"flashFade 0.3s forwards",pointerEvents:"none",zIndex:9999}}),(0,a.jsx)("div",{style:{position:"fixed",top:"".concat(n.y,"%"),left:"".concat(n.x,"%"),backgroundColor:"white",color:"black",padding:"1rem 2rem",borderRadius:4,boxShadow:"0 0 10px rgba(0,0,0,0.2)",fontWeight:"bold",fontSize:"1.5rem",pointerEvents:"none",zIndex:1e4,fontFamily:"Courier New"},children:"CLICK."})]}):null});var o=s(5),c=s(3610),d=s(1912);function u(e){let{id:t,spot:s,licenseplate:l,make:n,model:r,firstname:i,lastname:o,entry:c}=e;return(0,a.jsxs)("div",{className:"border w-150 mx-auto my-10",children:[(0,a.jsxs)("h1",{className:"text-xl font-bold my-8",children:["PARKING SLIP #",t.padStart(6,"0")]}),(0,a.jsx)("div",{className:"px-20 my-4",children:(0,a.jsxs)("div",{style:{fontFamily:"Consolas"},children:[(0,a.jsxs)("p",{className:"px-5 my-4",children:["PARKING SPOT: ",s]}),(0,a.jsxs)("p",{className:"px-5 my-4",children:["LICENSE PLATE: ",l]}),(0,a.jsxs)("p",{className:"px-5 my-4",children:["VEHCILE: ","".concat(n.toUpperCase()," ").concat(r.toUpperCase())]}),(0,a.jsxs)("p",{className:"px-5 my-4",children:["CUSTOMER NAME: ","".concat(i.toUpperCase()," ").concat(o.toUpperCase())]}),(0,a.jsxs)("p",{className:"px-5 my-4",children:["ENTRY TIME: ",c," "]}),(0,a.jsx)(d.A,{number:t.padStart(6,"0")})]})})]})}var x=function(e){return e.LOT_FULL="FULL",e.SERVER_ERROR="ERROR",e.LOADING="LOADING",e.SUCCESS="SUCCESS",e}(x||{});function m(){let{user:e}=(0,l.A)(),t=(0,n.useRouter)(),[s,d]=(0,r.useState)(!0),[x,m]=(0,r.useState)(-1),[h,p]=(0,r.useState)(!0),[f,j]=(0,r.useState)(null),[v,S]=(0,r.useState)("SUCCESS"),N=(0,r.useRef)(null);return((0,r.useEffect)(()=>{d(!1)},[e,t]),s)?null:e?(localStorage.removeItem("redirect"),(0,a.jsxs)("div",{className:"w-full content-center",children:[(0,a.jsx)(i,{ref:N}),(0,a.jsx)("div",{className:"bg-white mx-auto gap-4 text-black w-3/4 border overflow-hidden",children:(0,a.jsxs)("div",{className:"flex flex-col w-full text-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold my-4",children:"PARKING PERMITS"}),(0,a.jsx)(c.A,{selectedLot:x,onLotSelect:e=>{let t=Number(e.target.value);j(null),S("SUCCESS"),m(t)}}),(0,a.jsx)("button",{className:"border mx-auto px-2 my-4 ".concat(-1===x?"text-gray-200":"hover:shadow-sm cursor-pointer"),onClick:()=>{var e;null==(e=N.current)||e.flash(),p(!0),o.nV.newParkingSlip(x).then(e=>{if(200==e.statusCode){let t=e.data.data;j(t),0==t.slip_id?S("FULL"):S("SUCCESS")}else S("ERROR")}).finally(()=>{p(!1)})},children:"Issue Parking Slip"}),"SUCCESS"==v&&f?(0,a.jsxs)("div",{className:"flex flex-col ".concat(h?"invisible":""),children:[(0,a.jsx)("div",{className:"w-1/2 mx-auto justify-center",children:(0,a.jsx)("p",{style:{fontFamily:"Consolas"},children:"Our state-of-the-art robo photographer has captured this vehicle's license plate and extracted the driver's personal information!"})}),(0,a.jsx)("div",{className:"bg-[url('/images/licenseplatebg.png')] bg-cover text-4xl text-blue-800 w-60 h-30 mx-auto mt-2",children:(0,a.jsx)("div",{className:"mt-12 font-[Impact] tracking-widest",children:f.licenseplate})}),(0,a.jsx)(u,{id:f.slip_id.toString(),spot:f.spot,licenseplate:f.licenseplate,make:f.make,model:f.model,firstname:f.firstname,lastname:f.lastname,entry:new Date(1e3*f.start).toLocaleString()})]}):null,"ERROR"==v?(0,a.jsx)("div",{className:"flex flex-col ".concat(h?"invisible":""),children:(0,a.jsx)("div",{className:"w-1/2 mx-auto text-center justify-center my-4",children:(0,a.jsxs)("div",{style:{fontFamily:"Consolas"},children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"OOPS!"}),(0,a.jsx)("p",{children:"It appears our increasing reliance on fancy auto-information scraping technology has backfired and, as a result, we are now unable to permit entry to new vehicles at this time."}),(0,a.jsx)("p",{children:"Our downfall has been brought upon us as a result of our own hubris!"})]})})}):null,"FULL"==v?(0,a.jsx)("div",{className:"flex flex-col ".concat(h?"invisible":""),children:(0,a.jsxs)("div",{className:"w-1/4 mx-auto text-center justify-center my-4 border",children:[(0,a.jsx)("h1",{className:"text-red-500 font-bold text-2xl",children:"LOT FULL"}),(0,a.jsx)("p",{children:"Please come back later."})]})}):null]})})]})):(localStorage.setItem("redirect","/parking/permit/"),t.push("/login/"),null)}function h(){return(0,a.jsx)(m,{})}}},e=>{var t=t=>e(e.s=t);e.O(0,[647,636,593,792],()=>t(423)),_N_E=e.O()}]);